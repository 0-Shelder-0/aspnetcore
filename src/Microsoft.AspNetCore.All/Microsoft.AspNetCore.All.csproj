<Project Sdk="Microsoft.NET.Sdk">

  <Import Project="..\..\build\common.props" />

  <PropertyGroup>
    <IncludeBuildOutput>false</IncludeBuildOutput>
    <TargetFramework>netcoreapp2.0</TargetFramework>
    <PackageTags>aspnetcore</PackageTags>
    <Description>Microsoft.AspNetCore.All</Description>
    <EnableApiCheck>false</EnableApiCheck>
    <PackageTargetFallback>$(PackageTargetFallback);portable-net45+win8+wp8+wpa81</PackageTargetFallback>
  </PropertyGroup>

  <ItemGroup>
   <PackageReference Include="@(FullMetaPackagePackageReference)" />
   <PackageReference Include="@(FullMetaPackagePackageNoRuntimeStoreReference)" />
   <ProjectReference Include="@(FullMetaPackageProjectReference)" PrivateAssets="None" />
  </ItemGroup>

  <ItemGroup>
    <Content Include="build\**\*.xml" PackagePath="%(Identity)" />
    <Content Include="build\**\*.targets" PackagePath="%(Identity)" />
  </ItemGroup>

  <Target Name="UpdateManifestVersionNumbers" BeforeTargets="GenerateNuspec">
    <PropertyGroup>
      <ManifestTargetsFile>$(MSBuildThisFileDirectory)build\PublishWithAspNetCoreTargetManifest.targets</ManifestTargetsFile>
    </PropertyGroup>

    <Exec Command="powershell.exe -command &quot;(Get-Content $(ManifestTargetsFile)).replace('__MANIFEST_VERSION__','$(VersionPrefix)-$(VersionSuffix)') | Set-Content $(ManifestTargetsFile)&quot;" Condition="'$(OS)' == 'Windows_NT'"/>
    <Exec Command="sed -i -e &quot;s/__MANIFEST_VERSION__/$(VersionPrefix)-$(VersionSuffix)/g&quot; $(ManifestTargetsFile)" Condition="'$(OS)' != 'Windows_NT'"/>
  </Target>

</Project>
